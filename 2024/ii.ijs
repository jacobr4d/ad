m =: LF splitstring 1!:1 < '2.in'
NB. part a
+/ > (<./@:(1&<: *. <:&3) +. <./@:(_3&<: *. <:&_1))@:(2&(-/\))@:(_1&".)&.> m
+/ > (*/@:(3&>:)@:| *. (1&=@:#@:~.@:* *. 0&~:@:*/))@:(2&(-/\))@:(_1&".)&.> m
+/>(+/@:(*/"1)@:(e.&1 2 3)@:(_1 1&(*"0 1)))@:(2&(-/\))@:(_1&".)&.>m
NB. part b
+/ > (+./"1) @: ((*/@:(3&>:)@:| *. (1&=@:#@:~.@:* *. 0&~:@:*/))"1)  @: (2&(-/\)"1) @: (1&(]\.)) @: (_1&".) &.> m
+/ > +./"1 @: ((+./@:(*/"1)@:(e.&1 2 3)@:(_1 1&(*"0 1)))"1) @: (2&(-/\)"1) @: (1&(]\.)) @: (_1&".) &.> m
+/ > +./"1 @: (((*/)@:(e.&1 2 3) +. (*/)@:(e.&_1 _2 _3))"1) @: (2&(-/\)"1) @: (1&(]\.)) @: (_1&".) &.> m